/* [1] */
SELECT FILME.COD_FILME, COUNT(*) as NUM_LOCACOES
FROM FILME
JOIN LOCACOES ON FILME.COD_FILME = LOCACOES.COD_FILME
GROUP BY FILME.COD_FILME;

/* [2] */
SELECT FILME.COD_FILME, FILME.FILME, LOCACOES.DATA_DEVOLUCAO, FILME.DIRETOR, CLIENTES.NOME
FROM FILME
JOIN LOCACOES ON FILME.COD_FILME = LOCACOES.COD_FILME
JOIN CLIENTES ON LOCACOES.COD_CLIENTE = CLIENTES.COD_CLIENTE
JOIN CATEGORIA ON FILME.COD_CATEGORIA = CATEGORIA.COD_CATEGORIA
WHERE CATEGORIA.NOME_CATEGORIA = 'Ação'
AND FILME.DIRETOR = 'Richard Donner'
AND CLIENTES.NOME = 'Edson Martin Feitosa';

/* [3] */
SELECT FILME.FILME, FILME.VALOR_LOCACAO, FILME.VALOR_LOCACAO * 0.1 as DESCONTO, 
FILME.VALOR_LOCACAO - FILME.VALOR_LOCACAO * 0.1 as VALOR_FINAL
FROM FILME;

/* [4] */
SELECT DISTINCT FILME.COD_FILME, FILME.FILME, CLIENTES.NOME, CLIENTES.CIDADE
FROM FILME
JOIN LOCACOES ON FILME.COD_FILME = LOCACOES.COD_FILME
JOIN CLIENTES ON LOCACOES.COD_CLIENTE = CLIENTES.COD_CLIENTE
WHERE CLIENTES.CIDADE = 'Votorantim';

/* [5] */
SELECT FILME.COD_FILME, FILME.FILME, LOCACOES.DATA_RETIRADA
FROM FILME
JOIN LOCACOES ON FILME.COD_FILME = LOCACOES.COD_FILME
WHERE LOCACOES.DATA_RETIRADA = CONVERT(DATE, GETDATE());

/* [6] */
SELECT SUM(FILME.VALOR_LOCACAO) as TOTAL_LUCRO
FROM FILME
JOIN LOCACOES ON FILME.COD_FILME = LOCACOES.COD_FILME
WHERE FILME.FILME = 'A vida é bela';

/* [7] */
SELECT FILME.DIRETOR, FILME.COD_FILME, COUNT(LOCACOES.COD_FILME) as QTD_LOCACOES
FROM FILME
JOIN LOCACOES ON FILME.COD_FILME = LOCACOES.COD_FILME
GROUP BY FILME.DIRETOR, FILME.COD_FILME;

/* [8] */
SELECT FILME.COD_FILME, FILME.FILME, CATEGORIA.NOME_CATEGORIA,CLIENTES.NOME
FROM CLIENTES
JOIN LOCACOES ON CLIENTES.COD_CLIENTE = LOCACOES.COD_CLIENTE
JOIN FILME ON LOCACOES.COD_FILME = FILME.COD_FILME
JOIN CATEGORIA ON FILME.COD_CATEGORIA = CATEGORIA.COD_CATEGORIA
WHERE CLIENTES.NOME = 'Maria Chiquinha';

/* [9] */
SELECT CLIENTES.COD_CLIENTE, CLIENTES.NOME, CLIENTES.TELEFONE, FILME.FILME
FROM CLIENTES
JOIN LOCACOES ON CLIENTES.COD_CLIENTE = LOCACOES.COD_CLIENTE
JOIN FILME ON LOCACOES.COD_FILME = FILME.COD_FILME
WHERE FILME.FILME = 'Constantine';

/* [10] */
SELECT CATEGORIA.COD_CATEGORIA, CATEGORIA.NOME_CATEGORIA, FILME.COD_FILME
FROM CATEGORIA
LEFT JOIN FILME ON CATEGORIA.COD_CATEGORIA = FILME.COD_CATEGORIA
WHERE FILME.COD_FILME IS NULL;